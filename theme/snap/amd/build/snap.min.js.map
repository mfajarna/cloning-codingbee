{"version":3,"sources":["../src/snap.js"],"names":["define","$","log","Headroom","util","personalMenu","coverImage","ProgressBar","templates","str","accessibility","messages","M","theme_snap","disableAll","brandColorSuccess","brandColorWarning","GRADE_DISPLAY_TYPE_PERCENTAGE","GRADE_DISPLAY_TYPE_PERCENTAGE_REAL","GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER","GRADE_DISPLAY_TYPE_REAL","GRADE_DISPLAY_TYPE_REAL_PERCENTAGE","GRADE_DISPLAY_TYPE_REAL_LETTER","getURLParams","href","ta","split","length","urlparams","items","params","i","item","key","val","window","on","mobileFormChecker","savebuttonsformrequired","savebuttonsformadvanced","width","append","movePHPErrorsToHeader","xdebugs","x","el","fontel","parentNode","br","prev","remove","msgs","addClass","errorcont","get_string","after","errorlink","onCoursePage","attr","indexOf","applyBlockHash","each","location","hash","urlParams","time","scrollToElement","formselectors","paramchecks","p","param","push","join","formurl","setForumStrings","processSearchString","searchString","trim","toLowerCase","tocSearchCourse","dataList","ua","navigator","userAgent","find","clone","html","removeClass","matches","dataItem","text","bodyClasses","extraclasses","listenHashChange","courseLib","lastHash","e","newHash","info","update","css","target","showSection","recentUpdatesFix","appendTo","prependTo","closest","createColoredDataCircle","nodePointer","dataCallback","valueCallback","circle","Circle","color","easing","strokeWidth","trailWidth","duration","value","endColor","setText","valueAnimate","animate","from","to","step","state","path","setAttribute","progressbarcircle","nodeValue","gradeFormat","addListeners","document","getAttribute","history","pushState","trigger","preventDefault","myElement","querySelector","headroom","initial","pinned","unpinned","top","notTop","onPin","onUnpin","init","keyCode","which","last","blur","off","event","toggleClass","focus","dispatchEvent","Event","$news","not","slideDown","is","supportsTouch","msPointerEnabled","tooltipNode","isFunction","tooltip","waitForFullScreenButton","checker","setInterval","clearInterval","click","snapInit","courseConfig","pageHasCourseContent","siteMaxBytes","forcePassChange","messageBadgeCountEnabled","userId","sitePolicyAcceptReqd","inAlternativeRole","brandColors","gradingConstants","cfg","context","contextid","snapTheme","require","CourseLibAmd","ready","prevAll","folders","index","folder","content","folderAssetTypeHeader","hasClass","courseImage","shortname","categoryid","categoryImage","tabHash","tab","scrollTop","changeNodeVisibilityOnChecked","selectorToCheck","selectorToChange","nodeToCheck","nodeToChange","show","hide","advFeedsCheckboxSelector","advFeedsLifeTimeSelector","firstlinkerror","secondlinkerror","thirdlinkerror","titlelinksettingone","titlelinksettingtwo","titlelinksettingthree","nextUntil","wrapAll","linktitlestyle","usedefaultname","getElementById","sname","checked","required","parent","removeAttr","id","modSettingsIdRe","onModSettings","test","onCourseSettings","onSectionSettings","pageNotInBlacklist","vital","mainForm","wrap","description","get_strings","component","done","stringsjs","activityCards","cardmultimedia","showdescription","filemanager","duedate","availablity","label","select","insertBefore","strDisabled","then","strings","strMessage","render","type","classes","message","op0","op1","selectNode","prepend","savebuttons","errorElements","localizedstring","pageInputs","conversationBadgeCount","focustarget","keypress","alternativeRoleHandler","customMenu","moodlePage","notificationsBtn","searchButton","adminMenuTrigger","lastElement","searchTabHandler","snapAxInit","scrollTo","behavior"],"mappings":"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","sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package   theme_snap\n * @copyright Copyright (c) 2015 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* exported snapInit */\n/* eslint no-invalid-this: \"warn\"*/\n\n/**\n * Main snap initialising function.\n */\ndefine(['jquery', 'core/log', 'theme_snap/headroom', 'theme_snap/util', 'theme_snap/personal_menu',\n        'theme_snap/cover_image', 'theme_snap/progressbar', 'core/templates', 'core/str', 'theme_snap/accessibility',\n        'theme_snap/messages'],\n    function($, log, Headroom, util, personalMenu, coverImage, ProgressBar, templates, str, accessibility, messages) {\n\n        'use strict';\n\n        /* eslint-disable camelcase */\n        M.theme_snap = M.theme_snap || {};\n        /* eslint-enable camelcase */\n\n        /**\n         * master switch for logging\n         * @type {boolean}\n         */\n        var loggingenabled = false;\n\n        if (!loggingenabled) {\n            log.disableAll(true);\n        } else {\n            log.enableAll(true);\n        }\n\n        /**\n         * Initialize pre SCSS and grading constants.\n         * New variables can be initialized if necessary.\n         * These variables are being passed from classes/output/shared.php,\n         * and being updated from php constants in snapInit.\n         */\n        var brandColorSuccess = '';\n        var brandColorWarning = '';\n        var GRADE_DISPLAY_TYPE_PERCENTAGE = '';\n        var GRADE_DISPLAY_TYPE_PERCENTAGE_REAL = '';\n        var GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER = '';\n        var GRADE_DISPLAY_TYPE_REAL = '';\n        var GRADE_DISPLAY_TYPE_REAL_PERCENTAGE = '';\n        var GRADE_DISPLAY_TYPE_REAL_LETTER = '';\n\n        /**\n         * Get all url parameters from href\n         * @param {string} href\n         * @returns {Array}\n         */\n        var getURLParams = function(href) {\n            // Create temporary array from href.\n            var ta = href.split('?');\n            if (ta.length < 2) {\n                return false; // No url params\n            }\n            // Get url params full string from href.\n            var urlparams = ta[1];\n\n            // Strip out hash component\n            urlparams = urlparams.split('#')[0];\n\n            // Get urlparam items.\n            var items = urlparams.split('&');\n\n            // Create params array of values hashed by key.\n            var params = [];\n            for (var i = 0; i < items.length; i++) {\n                var item = items[i].split('=');\n                var key = item[0];\n                var val = item[1];\n                params[key] = val;\n            }\n            return (params);\n        };\n\n        /**\n         * Change save and cancel buttons from forms to the bottom on mobile mode.\n         */\n        $(window).on('resize', function() {\n            mobileFormChecker();\n        });\n\n        var mobileFormChecker = function() {\n            var savebuttonsformrequired = $('div[role=main] .mform div.snap-form-required fieldset > div.form-group.fitem');\n            var savebuttonsformadvanced = $('div[role=main] .mform div.snap-form-advanced > div:nth-of-type(3)');\n            var width = $(window).width();\n            if (width < 767) {\n                $('.snap-form-advanced').append(savebuttonsformrequired);\n            } else if (width > 767)  {\n                $('.snap-form-required fieldset#id_general').append(savebuttonsformadvanced);\n            }\n        };\n\n        /**\n         * move PHP errors into header\n         *\n         * @author Guy Thomas\n         * @date 2014-05-19\n         */\n        var movePHPErrorsToHeader = function() {\n            // Remove <br> tags inserted before xdebug-error.\n            var xdebugs = $('.xdebug-error');\n            if (xdebugs.length) {\n                for (var x = 0; x < xdebugs.length; x++) {\n                    var el = xdebugs[x];\n                    var fontel = el.parentNode;\n                    var br = $(fontel).prev('br');\n                    $(br).remove();\n                }\n            }\n\n            // Get messages using the different classes we want to use to target debug messages.\n            var msgs = $('.xdebug-error, .php-debug, .debuggingmessage');\n\n            if (msgs.length) {\n                // OK we have some errors - lets shove them in the footer.\n                $(msgs).addClass('php-debug-footer');\n                var errorcont = $('<div id=\"footer-error-cont\"><h3>' +\n                    M.util.get_string('debugerrors', 'theme_snap') +\n                    '</h3><hr></div>');\n                $('#page-footer').append(errorcont);\n                $('#footer-error-cont').append(msgs);\n                // Add rulers\n                $('.php-debug-footer').after($('<hr>'));\n                // Lets also add the error class to the header so we know there are some errors.\n                $('#mr-nav').addClass('errors-found');\n                // Lets add an error link to the header.\n                var errorlink = $('<a class=\"footer-error-link btn btn-danger\" href=\"#footer-error-cont\">' +\n                    M.util.get_string('problemsfound', 'theme_snap') + ' <span class=\"badge\">' + (msgs.length) + '</span></a>');\n                $('#page-header').append(errorlink);\n            }\n        };\n\n        /**\n         * Are we on the course page?\n         * Note: This doesn't mean that we are in a course - Being in a course could mean that you are on a module page.\n         * This means that you are actually on the course page.\n         * @returns {boolean}\n         */\n        var onCoursePage = function() {\n            return $('body').attr('id').indexOf('page-course-view-') === 0;\n        };\n\n        /**\n         * Apply block hash to form actions etc if necessary.\n         */\n        /* eslint-disable no-invalid-this */\n        var applyBlockHash = function() {\n            // Add block hash to add block form.\n            if (onCoursePage()) {\n                $('.block_adminblock form').each(function() {\n                    /* eslint-disable no-invalid-this */\n                    $(this).attr('action', $(this).attr('action') + '#coursetools');\n                });\n            }\n\n            if (location.hash !== '') {\n                return;\n            }\n\n            var urlParams = getURLParams(location.href);\n\n            // If calendar navigation has been clicked then go back to calendar.\n            if (onCoursePage() && typeof (urlParams.time) !== 'undefined') {\n                location.hash = 'coursetools';\n                if ($('.block_calendar_month')) {\n                    util.scrollToElement($('.block_calendar_month'));\n                }\n            }\n\n            // Form selectors for applying blocks hash.\n            var formselectors = [\n                'body.path-blocks-collect #notice form'\n            ];\n\n            // There is no decent selector for block deletion so we have to add the selector if the current url has the\n            // appropriate parameters.\n            var paramchecks = ['bui_deleteid', 'bui_editid'];\n            for (var p in paramchecks) {\n                var param = paramchecks[p];\n                if (typeof (urlParams[param]) !== 'undefined') {\n                    formselectors.push('#notice form');\n                    break;\n                }\n            }\n\n            // If required, apply #coursetools hash to form action - this is so that on submitting form it returns to course\n            // page on blocks tab.\n            $(formselectors.join(', ')).each(function() {\n                // Only apply the blocks hash if a hash is not already present in url.\n                var formurl = $(this).attr('action');\n                if (formurl.indexOf('#') === -1\n                    && (formurl.indexOf('/course/view.php') > -1)\n                ) {\n                    $(this).attr('action', $(this).attr('action') + '#coursetools');\n                }\n            });\n        };\n\n        /**\n         * Set forum strings because there isn't a decent renderer for mod/forum\n         * It would be great if the official moodle forum module used a renderer for all output\n         *\n         * @author Guy Thomas\n         * @date 2014-05-20\n         */\n        var setForumStrings = function() {\n            $('.path-mod-forum tr.discussion td.topic.starter').attr('data-cellname',\n                M.util.get_string('forumtopic', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.picture:not(\\'.group\\')').attr('data-cellname',\n                M.util.get_string('forumauthor', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.picture.group').attr('data-cellname',\n                M.util.get_string('forumpicturegroup', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.replies').attr('data-cellname',\n                M.util.get_string('forumreplies', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.lastpost').attr('data-cellname',\n                M.util.get_string('forumlastpost', 'theme_snap'));\n        };\n\n        /**\n         * Process toc search string - trim, remove case sensitivity etc.\n         *\n         * @author Guy Thomas\n         * @param {string} searchString\n         * @returns {string}\n         */\n        var processSearchString = function(searchString) {\n            searchString = searchString.trim().toLowerCase();\n            return (searchString);\n        };\n\n        /**\n         * search course modules\n         *\n         * @author Stuart Lamour\n         * @param {array} dataList\n         */\n        var tocSearchCourse = function(dataList) {\n            // keep search input open\n            var i;\n            var ua = window.navigator.userAgent;\n            if (ua.indexOf('MSIE ') || ua.indexOf('Trident/')) {\n                // We have reclone datalist over again for IE, or the same search fails the second time round.\n                dataList = $(\"#toc-searchables\").find('li').clone(true);\n            }\n\n            // TODO - for 2.7 process search string called too many times?\n            var searchString = $(\"#toc-search-input\").val();\n            searchString = processSearchString(searchString);\n\n            if (searchString.length === 0) {\n                $('#toc-search-results').html('');\n                $(\"#toc-search-input\").removeClass('state-active');\n\n            } else {\n                $(\"#toc-search-input\").addClass('state-active');\n                var matches = [];\n                for (i = 0; i < dataList.length; i++) {\n                    var dataItem = dataList[i];\n                    if (processSearchString($(dataItem).text()).indexOf(searchString) > -1) {\n                        matches.push(dataItem);\n                    }\n                }\n                $('#toc-search-results').html(matches);\n            }\n        };\n\n        /**\n         * Apply body classes which could not be set by renderers - e.g. when a notice was outputted.\n         * We could do this in plain CSS if there was such a think as a parent selector.\n         */\n        var bodyClasses = function() {\n            var extraclasses = [];\n            if ($('#notice.snap-continue-cancel').length) {\n                extraclasses.push('hascontinuecancel');\n            }\n            $('body').addClass(extraclasses.join(' '));\n        };\n\n        /**\n         * Listen for hash changes / popstates.\n         * @param {CourseLibAmd} courseLib\n         */\n        var listenHashChange = function(courseLib) {\n            var lastHash = location.hash;\n            $(window).on('popstate hashchange', function(e) {\n                var newHash = location.hash;\n                log.info('hashchange');\n                if (newHash !== lastHash) {\n                    if (location.hash === '#primary-nav') {\n                        personalMenu.update();\n                    } else {\n                        $('#page, #moodle-footer, #js-snap-pm-trigger, #logo, .skiplinks').css('display', '');\n                        if (onCoursePage()) {\n                            log.info('show section', e.target);\n                            courseLib.showSection();\n                        }\n                    }\n                }\n                lastHash = newHash;\n            });\n        };\n\n        /**\n         * Course footer recent activity dom re-order.\n         */\n        var recentUpdatesFix = function() {\n            $('#snap-course-footer-recent-activity .info').each(function() {\n                $(this).appendTo($(this).prev());\n            });\n            $('#snap-course-footer-recent-activity .head .name').each(function() {\n                $(this).prependTo($(this).closest(\".head\"));\n            });\n        };\n\n        /**\n         * Apply progressbar.js for circular progress displays.\n         */\n        var createColoredDataCircle = function(nodePointer, dataCallback, valueCallback = null) {\n            var circle = new ProgressBar.Circle(nodePointer, {\n                color: 'inherit', // @gray.\n                easing: 'linear',\n                strokeWidth: 6,\n                trailWidth: 3,\n                duration: 1400,\n                text: {\n                    value: '0'\n                }\n            });\n            var value = ($(nodePointer).attr('value') / 100);\n            var endColor = brandColorSuccess; // Green @brand-success.\n            if (value === 0 || $(nodePointer).attr('value') === '-') {\n                circle.setText('-');\n            } else {\n                if ($(nodePointer).attr('value') < 50) {\n                    endColor = brandColorWarning; // Orange @brand-warning.\n                }\n                circle.setText(dataCallback(nodePointer));\n            }\n            var valueAnimate = 0;\n\n            if (valueCallback === null) {\n                valueAnimate = value;\n            } else {\n                valueAnimate = valueCallback(nodePointer);\n            }\n            circle.animate(valueAnimate, {\n                from: {\n                    color: '#999' // @gray-light.\n                },\n                to: {\n                    color: endColor\n                },\n                step: function(state, circle) {\n                    circle.path.setAttribute('stroke', state.color);\n                }\n            });\n        };\n\n        var progressbarcircle = function() {\n            $('.snap-student-dashboard-progress .js-progressbar-circle').each(function() {\n                createColoredDataCircle(this, function(nodePointer) {\n                    return $(nodePointer).attr('value') + '<small>%</small>';\n                });\n            });\n\n            $('.snap-student-dashboard-grade .js-progressbar-circle').each(function() {\n                createColoredDataCircle(this, function(nodePointer) {\n                    var nodeValue = $(nodePointer).attr('value');\n                    var gradeFormat = $(nodePointer).attr('gradeformat');\n\n                    /**\n                     * Definitions for gradebook.\n                     *\n                     * We need to display the % for all the grade formats which contains a % in the value.\n                     */\n                    if (gradeFormat == GRADE_DISPLAY_TYPE_PERCENTAGE\n                        || gradeFormat == GRADE_DISPLAY_TYPE_PERCENTAGE_REAL\n                        || gradeFormat == GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER) {\n                        nodeValue = nodeValue + '<small>%</small>';\n                    }\n                    return nodeValue;\n                }, function (nodePointer){\n                    var valueAnimate = $(nodePointer).attr('value');\n                    var gradeFormat = $(nodePointer).attr('gradeformat');\n\n                    if (gradeFormat == GRADE_DISPLAY_TYPE_REAL\n                        || gradeFormat == GRADE_DISPLAY_TYPE_REAL_PERCENTAGE\n                        || gradeFormat == GRADE_DISPLAY_TYPE_REAL_LETTER) {\n                        valueAnimate = 0;\n                    } else {\n                        valueAnimate = ($(nodePointer).attr('value') / 100);\n                    }\n                    return valueAnimate;\n                });\n            });\n        };\n\n        /**\n         * Add listeners.\n         *\n         * just a wrapper for various snippets that add listeners\n         */\n        var addListeners = function() {\n            var selectors = [\n                '.chapters a',\n                '.section_footer a',\n                ' #toc-search-results a'\n            ];\n\n            $(document).on('click', selectors.join(', '), function(e) {\n                var href = this.getAttribute('href');\n                if (window.history && window.history.pushState) {\n                    history.pushState(null, null, href);\n                    // Force hashchange fix for FF & IE9.\n                    $(window).trigger('hashchange');\n                    // Prevent scrolling to section.\n                    e.preventDefault();\n                } else {\n                    location.hash = href;\n                }\n            });\n\n            // Show fixed header on scroll down\n            // using headroom js - http://wicky.nillia.ms/headroom.js/\n            var myElement = document.querySelector(\"#mr-nav\");\n            // Functions added to trigger on pin and unpin actions for the nav bar\n            var onPin = () => {\n                $('.snap-drawer-no-headroom').addClass('snap-drawer-headroom');\n                $('.snap-drawer-headroom').removeClass('snap-drawer-no-headroom');\n            };\n            var onUnpin = () => {\n                $('.snap-drawer-headroom').addClass('snap-drawer-no-headroom');\n                $('.snap-drawer-no-headroom').removeClass('snap-drawer-headroom');\n            };\n            // Construct an instance of Headroom, passing the element.\n            var headroom = new Headroom(myElement, {\n                \"tolerance\": 5,\n                \"offset\": 100,\n                \"classes\": {\n                    // when element is initialised\n                    initial: \"headroom\",\n                    // when scrolling up\n                    pinned: \"headroom--pinned\",\n                    // when scrolling down\n                    unpinned: \"headroom--unpinned\",\n                    // when above offset\n                    top: \"headroom--top\",\n                    // when below offset\n                    notTop: \"headroom--not-top\"\n                },\n                \"onPin\": onPin,\n                \"onUnpin\": onUnpin\n            });\n            // When not signed in always show mr-nav?\n            if (!$('.notloggedin').length) {\n                headroom.init();\n            }\n\n            // Listener for toc search.\n            var dataList = $(\"#toc-searchables\").find('li').clone(true);\n            $('#course-toc').on('keyup', '#toc-search-input', function() {\n                tocSearchCourse(dataList);\n            });\n\n            // Handle keyboard navigation of search items.\n            $('#course-toc').on('keydown', '#toc-search-input', function(e) {\n                var keyCode = e.keyCode || e.which;\n                if (keyCode === 9) {\n                    // 9 tab\n                    // 13 enter\n                    // 40 down arrow\n                    // Register listener for exiting search result.\n                    $('#toc-search-results a').last().blur(function() {\n                        $(this).off('blur'); // unregister listener\n                        $(\"#toc-search-input\").val('');\n                        $('#toc-search-results').html('');\n                        $(\"#toc-search-input\").removeClass('state-active');\n                    });\n\n                }\n            });\n\n            $('#course-toc').on(\"click\", '#toc-search-results a', function() {\n                $(\"#toc-search-input\").val('');\n                $('#toc-search-results').html('');\n                $(\"#toc-search-input\").removeClass('state-active');\n            });\n\n            /**\n             * When the document is clicked, if the closest object that was clicked was not the search input then close\n             * the search results.\n             * Note that this is triggered also when you click on a search result as the results should no longer be\n             * required at that point.\n             */\n            $(document).on('click', function(event) {\n                if (!$(event.target).closest('#toc-search-input').length) {\n                    $(\"#toc-search-input\").val('');\n                    $('#toc-search-results').html('');\n                    $(\"#toc-search-input\").removeClass('state-active');\n                }\n            });\n\n            // Onclick for toggle of state-visible of admin block and mobile menu.\n            $(document).on(\"click\", \"#admin-menu-trigger, #toc-mobile-menu-toggle\", function(e) {\n                var href = this.getAttribute('href');\n                // Make this only happen for settings button.\n                if (this.getAttribute('id') === 'admin-menu-trigger') {\n                    $(this).toggleClass('active');\n                    $('#page').toggleClass('offcanvas');\n                }\n                $(href).attr('tabindex', '0');\n                $(href).toggleClass('state-visible').focus();\n                e.preventDefault();\n\n                if ($('.message-app.main').length === 0) {\n                    document.dispatchEvent(new Event(\"messages-drawer:toggle\"));\n                }\n            });\n\n            // Mobile menu button.\n            $(document).on(\"click\", \"#course-toc.state-visible a\", function() {\n                $('#course-toc').removeClass('state-visible');\n            });\n\n            $(document).on(\"click\", \".news-article .toggle\", function(e) {\n                var $news = $(this).closest('.news-article');\n                util.scrollToElement($news);\n                $(\".news-article\").not($news).removeClass('state-expanded');\n                $(\".news-article-message\").css('display', 'none');\n\n                $news.toggleClass('state-expanded');\n                $('.state-expanded').find('.news-article-message').slideDown(\"fast\", function() {\n                    // Animation complete.\n                    if ($news.is('.state-expanded')) {\n                        $news.find('.news-article-message').focus();\n                        $news.attr('aria-expanded', 'true');\n                    } else {\n                        $news.focus();\n                        $news.attr('aria-expanded', 'false');\n                    }\n                    $(document).trigger('snapContentRevealed');\n                });\n                e.preventDefault();\n            });\n\n            // Bootstrap js elements.\n\n            // Iniitalise core bootstrap tooltip js.\n            $(function() {\n                var supportsTouch = false;\n                if ('ontouchstart' in window) {\n                    // iOS & android\n                    supportsTouch = true;\n                } else if (window.navigator.msPointerEnabled) {\n                    // Win8\n                    supportsTouch = true;\n                }\n                if (!supportsTouch) {\n                    var tooltipNode = $('[data-toggle=\"tooltip\"]');\n                    if ($.isFunction(tooltipNode.tooltip)) {\n                        tooltipNode.tooltip();\n                    }\n                }\n            });\n        };\n\n        /**\n         * Function to fix the styles when fullscreen is used with Atto Editor.\n         */\n        function waitForFullScreenButton() {\n            var maxIterations = 15;\n            var i = 0;\n            var checker = setInterval(function() {\n                i = i + 1;\n                if (i > maxIterations) {\n                    clearInterval(checker);\n                } else {\n                    if ($('button.atto_fullscreen_button').length != 0 && $('div.editor_atto').length != 0) {\n                        $('button.atto_fullscreen_button').click(function() {\n                            $('div.editor_atto').css('background-color', '#eee');\n                            $('div.editor_atto').css('z-index', '1');\n                        });\n                        $('button.atto_html_button').click(function() {\n                            $('#id_introeditor').css('z-index', '1');\n                        });\n                        clearInterval(checker);\n                    }\n                }\n            }, 2000);\n        }\n\n        /**\n         * AMD return object.\n         */\n        return {\n            /**\n             * Snap initialise function.\n             * @param {object} courseConfig\n             * @param {bool} pageHasCourseContent\n             * @param {int} siteMaxBytes\n             * @param {bool} forcePassChange\n             * @param {bool} messageBadgeCountEnabled\n             * @param {int} userId\n             * @param {bool} sitePolicyAcceptReqd\n             * @param {bool} inAlternativeRole\n             * @param {string} brandColors\n             * @param {int} gradingConstants\n             * @param {boolean} isAdmin\n             */\n            snapInit: function(courseConfig, pageHasCourseContent, siteMaxBytes, forcePassChange,\n                               messageBadgeCountEnabled, userId, sitePolicyAcceptReqd, inAlternativeRole,\n                               brandColors, gradingConstants) {\n\n                // Set up.\n\n                // Branding colors. New colors can be set up if necessary.\n                brandColorSuccess = brandColors['success'];\n                brandColorWarning = brandColors['warning'];\n                // Grading constants for percentage.\n                GRADE_DISPLAY_TYPE_PERCENTAGE = gradingConstants['gradepercentage'];\n                GRADE_DISPLAY_TYPE_PERCENTAGE_REAL = gradingConstants['gradepercentagereal'];\n                GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER = gradingConstants['gradepercentageletter'];\n                GRADE_DISPLAY_TYPE_REAL = gradingConstants['gradereal'];\n                GRADE_DISPLAY_TYPE_REAL_PERCENTAGE = gradingConstants['graderealpercentage'];\n                GRADE_DISPLAY_TYPE_REAL_LETTER = gradingConstants['graderealletter'];\n\n                M.cfg.context = courseConfig.contextid;\n                M.snapTheme = {forcePassChange: forcePassChange};\n\n                // General AMD modules.\n                personalMenu.init(sitePolicyAcceptReqd);\n\n                // Course related AMD modules (note, site page can technically have course content too).\n                if (pageHasCourseContent) {\n                    require(\n                        [\n                            'theme_snap/course-lazy'\n                        ], function(CourseLibAmd) {\n                            // Instantiate course lib.\n                            var courseLib = new CourseLibAmd(courseConfig);\n\n                            // Hash change listener goes here because it requires courseLib.\n                            listenHashChange(courseLib);\n                        }\n                    );\n                }\n\n                // When document has loaded.\n                /* eslint-disable complexity */\n                $(document).ready(function() {\n                    movePHPErrorsToHeader(); // boring\n                    setForumStrings(); // whatever\n                    addListeners(); // essential\n                    applyBlockHash(); // change location hash if necessary\n                    bodyClasses(); // add body classes\n                    mobileFormChecker();\n\n                    // Make sure that the blocks are always within page-content for assig view page.\n                    $('#page-mod-assign-view #page-content').append($('#moodle-blocks'));\n\n                    // Append resource card fadeout to content resource card.\n                    $('.snap-resource-long .contentafterlink .snap-resource-card-fadeout').each(function() {\n                        $(this).appendTo($(this).prevAll('.snap-resource-long .contentafterlink .no-overflow'));\n                    });\n\n                    // Remove from Dom the completion tracking when it is disabled for an activity.\n                    $('.snap-header-card .snap-header-card-icons .disabled-snap-asset-completion-tracking').remove();\n\n                    // Prepend asset type when activity is a folder to appear in the card header instead of the content.\n                    var folders = $('li.snap-activity.modtype_folder');\n                    $.each(folders, function (index, folder) {\n                        var content = $(folder).find('div.contentwithoutlink div.snap-assettype');\n                        if (content.length > 0) {\n                            if ($(folder).find('div.activityinstance div.snap-header-card .asset-type').length == 0) {\n                                var folderAssetTypeHeader = $(folder).find('div.activityinstance div.snap-header-card');\n                                content.prependTo(folderAssetTypeHeader);\n                            }\n                        }\n                    });\n\n                    // Add a class to the body to show js is loaded.\n                    $('body').addClass('snap-js-loaded');\n                    // Apply progressbar.js for circluar progress display.\n                    progressbarcircle();\n                    // Course footer recent updates dom fixes.\n                    recentUpdatesFix();\n\n                    if ($('body').hasClass('pagelayout-course') || $('body').hasClass('pagelayout-frontpage')) {\n                        coverImage.courseImage(courseConfig.shortname, siteMaxBytes);\n                    } else if ($('body').hasClass('pagelayout-coursecategory')) {\n                        if (courseConfig.categoryid) {\n                            coverImage.categoryImage(courseConfig.categoryid, siteMaxBytes);\n                        }\n                    }\n\n                    // Allow deeplinking to bs tabs on snap settings page.\n                    if ($('#page-admin-setting-themesettingsnap').length) {\n                        var tabHash = location.hash;\n                        // Check link is to a tab hash.\n                        if (tabHash && $('.nav-link[href=\"' + tabHash + '\"]').length) {\n                            $('.nav-link[href=\"' + tabHash + '\"]').tab('show');\n                            $(window).scrollTop(0);\n                        }\n\n                        // Hide advanced feeds additional life time setting when advanced feeds are disabled.\n                        var changeNodeVisibilityOnChecked = function(selectorToCheck, selectorToChange) {\n                            var nodeToCheck = $(selectorToCheck), nodeToChange = $(selectorToChange);\n                            if (nodeToCheck.is(':checked')) {\n                                nodeToChange.show();\n                                return;\n                            }\n                            nodeToChange.hide();\n                        };\n                        var advFeedsCheckboxSelector = '#id_s_theme_snap_personalmenuadvancedfeedsenable';\n                        var advFeedsLifeTimeSelector = '#admin-personalmenuadvancedfeedslifetime';\n                        changeNodeVisibilityOnChecked(advFeedsCheckboxSelector, advFeedsLifeTimeSelector);\n                        $(advFeedsCheckboxSelector).on('click', function() {\n                            changeNodeVisibilityOnChecked(advFeedsCheckboxSelector, advFeedsLifeTimeSelector);\n                        });\n                    }\n\n                    // Add extra padding when the error validation message appears at the moment of enter a not valid\n                    // URL for feature spots.\n                    var firstlinkerror = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_one_title_link span.error');\n                    var secondlinkerror = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_two_title_link span.error');\n                    var thirdlinkerror = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_three_title_link span.error');\n                    var titlelinksettingone = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_one_title_link .form-label');\n                    var titlelinksettingtwo = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_two_title_link .form-label');\n                    var titlelinksettingthree = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_three_title_link .form-label');\n                    // Create an extra Div to wrap title links settings to avoid line break.\n                    $('#page-admin-setting-themesettingsnap #themesnapfeaturespots ' +\n                        '#admin-fs_three_title').nextUntil('#page-admin-setting-themesettingsnap #themesnapfeaturespots ' +\n                        '#admin-fs_one_title_link_cb').wrapAll(\"<div class=fs-title-links></div>\");\n                    var linktitlestyle = {'padding-bottom': '2.1em'};\n\n                    // We need to modify the padding of these elements depending on the case, because when validating\n                    // the link and throwing an error, this will create an extra height to the parent and can break\n                    // the visualization of the settings page for Feature spots.\n                    if ((firstlinkerror).length) {\n                        titlelinksettingtwo.css(linktitlestyle);\n                        titlelinksettingthree.css(linktitlestyle);\n                    }\n                    if ((secondlinkerror).length) {\n                        titlelinksettingone.css(linktitlestyle);\n                        titlelinksettingthree.css(linktitlestyle);\n                    }\n                    if ((thirdlinkerror).length) {\n                        titlelinksettingone.css(linktitlestyle);\n                        titlelinksettingtwo.css(linktitlestyle);\n                    }\n\n                    if ($('body').hasClass('snap-pm-open')) {\n                        personalMenu.update();\n                    }\n\n                    // SHAME - make section name creation mandatory\n                    if ($('#page-course-editsection.format-topics').length) {\n                        var usedefaultname = document.getElementById('id_name_customize'),\n                            sname = document.getElementById('id_name_value');\n                        usedefaultname.value = '1';\n                        usedefaultname.checked = true;\n                        sname.required = \"required\";\n                        // Make sure that section does have at least one character.\n                        $(sname).attr(\"pattern\", \".*\\\\S+.*\");\n                        $(usedefaultname).parent().css('display', 'none');\n\n                        // Enable the cancel button.\n                        $('#id_cancel').on('click', function() {\n                            $(sname).removeAttr('required');\n                            $(sname).removeAttr('pattern');\n                            return true;\n                        });\n                    // Make sure that in other formats, \"only spaces\" name is not available.\n                    } else {\n                        $('#id_name_value').attr(\"pattern\", \".*\\\\S+.*\");\n                        $('#id_cancel').on('click', function() {\n                            $(sname).removeAttr('pattern');\n                            return true;\n                        });\n                    }\n\n                    // Book mod print button, only show if print link already present.\n                    if ($('#page-mod-book-view a[href*=\"mod/book/tool/print/index.php\"]').length) {\n                        var urlParams = getURLParams(location.href);\n                        if (urlParams) {\n                            $('[data-block=\"_fake\"]').append('<p>' +\n                                '<hr><a target=\"_blank\" href=\"/mod/book/tool/print/index.php?id=' + urlParams.id + '\">' +\n                                M.util.get_string('printbook', 'booktool_print') +\n                                '</a></p>');\n                        }\n                    }\n\n                    var modSettingsIdRe = /^page-mod-.*-mod$/; // e.g. #page-mod-resource-mod or #page-mod-forum-mod\n                    var onModSettings = modSettingsIdRe.test($('body').attr('id')) && location.href.indexOf(\"modedit\") > -1;\n                    if (!onModSettings) {\n                        modSettingsIdRe = /^page-mod-.*-general$/;\n                        onModSettings = modSettingsIdRe.test($('body').attr('id')) && location.href.indexOf(\"modedit\") > -1;\n                    }\n                    var onCourseSettings = $('body').attr('id') === 'page-course-edit';\n                    var onSectionSettings = $('body').attr('id') === 'page-course-editsection';\n                    $('#page-mod-hvp-mod .h5p-editor-iframe').parent().css({\"display\": \"block\"});\n                    var pageBlacklist = ['page-mod-hvp-mod'];\n                    var pageNotInBlacklist = pageBlacklist.indexOf($('body').attr('id')) === -1;\n\n                    if ((onModSettings || onCourseSettings || onSectionSettings) && pageNotInBlacklist) {\n                        // Wrap advanced options in a div\n                        var vital = [\n                            ':first',\n                            '#page-course-edit #id_descriptionhdr',\n                            '#id_contentsection',\n                            '#id_general + #id_general', // Turnitin duplicate ID bug.\n                            '#id_content',\n                            '#page-mod-choice-mod #id_optionhdr',\n                            '#page-mod-workshop-mod #id_gradingsettings',\n                            '#page-mod-choicegroup-mod #id_miscellaneoussettingshdr',\n                            '#page-mod-choicegroup-mod #id_groups',\n                            '#page-mod-scorm-mod #id_packagehdr'\n                        ];\n                        vital = vital.join();\n\n                        $('form[id^=\"mform1\"] > fieldset').not(vital).wrapAll('<div class=\"snap-form-advanced col-md-4\" />');\n\n                        // Add expand all to advanced column.\n                        $(\".snap-form-advanced\").append($(\".collapsible-actions\"));\n                        // Add collapsed to all fieldsets in advanced, except on course edit page.\n                        if (!$('#page-course-edit').length) {\n                            $(\".snap-form-advanced fieldset\").addClass('collapsed');\n                        }\n\n                        // Sanitize required input into a single fieldset\n                        var mainForm = $('form[id^=\"mform1\"] fieldset:first');\n                        var appendTo = $('form[id^=\"mform1\"] fieldset:first .fcontainer');\n\n                        var required = $('form[id^=\"mform1\"] > fieldset').not('form[id^=\"mform1\"] > fieldset:first');\n                        for (var i = 0; i < required.length; i++) {\n                            var content = $(required[i]).find('.fcontainer');\n                            $(appendTo).append(content);\n                            $(required[i]).remove();\n                        }\n                        $(mainForm).wrap('<div class=\"snap-form-required col-md-8\" />');\n\n                        var description = $('form[id^=\"mform1\"] fieldset:first .fitem_feditor:not(.required)');\n\n                        if (onModSettings && description) {\n                            var noNeedDescSelectors = [\n                                'body#page-mod-assign-mod',\n                                'body#page-mod-choice-mod',\n                                'body#page-mod-turnitintool-mod',\n                                'body#page-mod-workshop-mod',\n                            ];\n                            var addMultiMessageSelectors = [\n                                'body#page-mod-url-mod',\n                                'body#page-mod-resource-mod',\n                                'body#page-mod-folder-mod',\n                                'body#page-mod-imscp-mod',\n                                'body#page-mod-lightboxgallery-mod',\n                                'body#page-mod-scorm-mod',\n                            ];\n                            if ($(noNeedDescSelectors.join()).length === 0) {\n                                $(appendTo).append(description);\n                                $(appendTo).append($('#fitem_id_showdescription'));\n                            }\n                            // Resource cards - add a message to this type of activities, these activities will not display\n                            // any multimedia.\n                            if ($(addMultiMessageSelectors.join()).length > 0) {\n                                str.get_strings([\n                                    {key : 'multimediacard', component : 'theme_snap'}\n                                ]).done(function(stringsjs) {\n                                    var activityCards = stringsjs[0];\n                                    var cardmultimedia = $(\"[id='id_showdescription']\").closest('.form-group');\n                                    $(cardmultimedia).append(activityCards);\n                                });\n                            }\n                        }\n\n                        // Resources - put description in common mod settings.\n                        description = $(\"#page-mod-resource-mod [data-fieldtype='editor']\").closest('.form-group');\n                        var showdescription = $(\"#page-mod-resource-mod [id='id_showdescription']\").closest('.form-group');\n                        $(\"#page-mod-resource-mod .snap-form-advanced #id_modstandardelshdr .fcontainer\").append(description);\n                        $(\"#page-mod-resource-mod .snap-form-advanced #id_modstandardelshdr .fcontainer\").append(showdescription);\n\n                        // Assignment - put due date in required, and attatchments in common settings.\n                        var filemanager = $(\"#page-mod-assign-mod [data-fieldtype='filemanager']\").closest('.form-group');\n                        var duedate = $(\"#page-mod-assign-mod [for='id_duedate']\").closest('.form-group');\n                        $(\"#page-mod-assign-mod .snap-form-advanced #id_modstandardelshdr .fcontainer\").append(filemanager);\n                        $(\"#page-mod-assign-mod .snap-form-required .fcontainer\").append(duedate);\n\n                        // Move availablity at the top of advanced settings.\n                        var availablity = $('#id_visible').closest('.form-group').addClass('snap-form-visibility');\n                        var label = $(availablity).find('label');\n                        var select = $(availablity).find('select');\n                        $(label).insertBefore(select);\n\n                        // SHAME - rewrite visibility form lang string to be more user friendly.\n                        $(label).text(M.util.get_string('visibility', 'theme_snap') + ' ');\n\n                        if ($(\"#page-course-edit\").length) {\n                            // We are in course editing form.\n                            // Removing the \"Show all sections in one page\" from the course format form.\n                            var strDisabled = \"\";\n                            (function(){\n                                return str.get_strings([\n                                    {key: 'showallsectionsdisabled', component: 'theme_snap'},\n                                    {key: 'disabled', component: 'theme_snap'}\n                                ]);\n                            })()\n                                .then(function(strings) {\n                                    var strMessage = strings[0];\n                                    strDisabled = strings[1];\n                                    return templates.render('theme_snap/form_alert', {\n                                        type: 'warning',\n                                        classes: '',\n                                        message: strMessage\n                                    });\n                                })\n                                .then(function(html) {\n                                    var op0 = $('[name=\"coursedisplay\"] > option[value=\"0\"]');\n                                    var op1 = $('[name=\"coursedisplay\"] > option[value=\"1\"]');\n                                    var selectNode =  $('[name=\"coursedisplay\"]');\n                                    // Disable option 0\n                                    op0.attr('disabled','disabled');\n                                    // Add \"(Disabled)\" to option text\n                                    op0.append(' (' + strDisabled + ')');\n                                    // Remove selection attribute\n                                    op0.removeAttr(\"selected\");\n                                    // Select option 1\n                                    op1.attr('selected','selected');\n                                    // Add warning\n                                    selectNode.parent().append(html);\n                                });\n                        }\n\n                        $('.snap-form-advanced').prepend(availablity);\n\n                        // Add save buttons.\n                        var savebuttons = $('form[id^=\"mform1\"] > .form-group:last');\n                        $(mainForm).append(savebuttons);\n\n                        // Expand collapsed fieldsets when editing a mod that has errors in it.\n                        var errorElements = $('.form-group.has-danger');\n                        if (onModSettings && errorElements.length) {\n                            errorElements.closest('.collapsible').removeClass('collapsed');\n                        }\n\n                        // Hide appearance menu from interface when editing a page-resource.\n                        if ($(\"#page-mod-page-mod\").length) {\n                            // Chaining promises to get localized strings and render warning message.\n                            (function() {\n                                return str.get_strings([\n                                    {key: 'showappearancedisabled', component: 'theme_snap'}\n                                ]);\n                            })()\n                                .then(function(localizedstring){\n                                    return templates.render('theme_snap/form_alert', {\n                                        type: 'warning',\n                                        classes: '',\n                                        message: localizedstring\n                                    });\n                                })\n                                // eslint-disable-next-line promise/always-return\n                                .then(function(html) {\n                                    // Disable checkboxes.\n                                    // Colors for disabling the divs.\n                                    var layoverbkcolor = \"#f1f1f1\";\n                                    var layovercolor = \"#d5d5d5\";\n                                    var pageInputs = $('[id=\"id_printheading\"], [id=\"id_printintro\"],' +\n                                        ' [id=\"id_printlastmodified\"], [id=\"id_display\"],' +\n                                        ' [id=\"id_popupwidth\"], [id=\"id_popupheight\"]');\n\n                                    // This will help with disable the multiple options for the select, and let the one by default.\n                                    // Allowing to submit the form.\n                                    $('#id_display option:not(:selected)').attr('disabled', true);\n\n                                    // Note we can't use 'disabled' for settings or they don't get submitted.\n                                    pageInputs.attr('readonly', true);\n                                    pageInputs.attr('tabindex', -1); // Prevent tabbing to change val.\n                                    pageInputs.click(function(e) {\n                                        e.preventDefault();\n                                        return false;\n                                    });\n                                    pageInputs.parent().parent().parent().css('background-color', layoverbkcolor);\n                                    pageInputs.parent().parent().parent().css('color', layovercolor);\n\n                                    // Add warning.\n                                    var selectNode = $('[id=\"id_error_printheading\"]');\n                                    selectNode.parent().parent().parent().append(html);\n                                });\n                        }\n                    }\n\n                    // Conversation counter for user badge.\n                    if (messageBadgeCountEnabled) {\n                        require(\n                            [\n                                'theme_snap/conversation_badge_count-lazy'\n                            ], function(conversationBadgeCount) {\n                                conversationBadgeCount.init(userId);\n                            }\n                        );\n                    }\n\n                    // Listen to cover image label key press for accessible usage.\n                    var focustarget = $('#snap-coverimagecontrol label');\n                    if (focustarget && focustarget.length) {\n                        focustarget.keypress(function (e) {\n                            if (e.which === 13) {\n                                $('#snap-coverfiles').trigger('click');\n                            }\n                        });\n                    }\n\n                    // Review if settings block is missing.\n                    if (!$('.block_settings').length) {\n                        // Hide admin icon.\n                        $('#admin-menu-trigger').hide();\n                        if (inAlternativeRole) {\n                            // Handle possible alternative role.\n                            require(\n                                [\n                                    'theme_snap/alternative_role_handler-lazy'\n                                ], function(alternativeRoleHandler) {\n                                    alternativeRoleHandler.init(courseConfig.id);\n                                }\n                            );\n                        }\n                    }\n\n                    // Add tab logic order to navigation bar icons, part of this order is being taken from the layout nav.php file.\n                    var customMenu = $('ul.snap-navbar-content li:first-child a');\n                    var moodlePage = $(\"#moodle-page a:first\");\n                    var notificationsBtn = $('#nav-notification-popover-container > div.popover-region-toggle.nav-link');\n                    var searchButton = $('#mr-nav .simplesearchform a.btn.btn-open');\n                    var adminMenuTrigger = $('#admin-menu-trigger');\n\n                    var lastElement;\n                    if (customMenu.length) {\n                        lastElement = customMenu;\n                    } else {\n                        lastElement = moodlePage;\n                    }\n                    if (notificationsBtn.length && searchButton.length && adminMenuTrigger.length && lastElement.length) {\n                        // Update tab events because all elements have tabindex=\"0\" and they are rendered funny.\n                        require(\n                            [\n                                'theme_snap/rearrange_tab_handler-lazy'\n                            ], function(searchTabHandler) {\n                                searchTabHandler.init([notificationsBtn, searchButton, adminMenuTrigger, lastElement]);\n                            }\n                        );\n                    }\n\n                    // Add settings tab show behaviour to classes which want to do that.\n                    $('.snap-settings-tab-link').on('click', function() {\n                        var tab = $('a[href=\"' + $(this).attr('href') + '\"].nav-link');\n                        if (tab.length) {\n                            tab.tab('show');\n                        }\n                    });\n\n                    // Unpin headroom when url has #course-detail-title.\n                    if (window.location.hash === '#course-detail-title') {\n                        $('#mr-nav').removeClass('headroom--pinned').addClass('headroom--unpinned');\n                    }\n\n                    // Re position submit buttons for forms when using mobile mode at the bottom of the form.\n                    var savebuttonsformrequired = $('div[role=main] .mform div.snap-form-required fieldset > div.form-group.fitem');\n                    var width = $(window).width();\n                    if (width < 767) {\n                        $('.snap-form-advanced').append(savebuttonsformrequired);\n                    }\n\n                    waitForFullScreenButton();\n                });\n                accessibility.snapAxInit();\n                messages.init();\n\n                // Smooth scroll for go to top button.\n                $(\"div#goto-top-link > a\").click(function() {\n                    window.scrollTo({ top: 0, behavior: 'smooth' });\n                });\n            }\n        };\n    }\n);\n"],"file":"snap.min.js"}