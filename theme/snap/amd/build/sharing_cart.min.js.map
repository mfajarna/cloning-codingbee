{"version":3,"sources":["../src/sharing_cart.js"],"names":["courseSections","identifier","M","str","block_sharing_cart","moodle","create_command","cssClass","title","imageUrl","addClass","attr","append","spinner","snapSpinner","show","hide","input","restore_targets","course","param","get_action_url","ModalFactory","ModalEvents","id","sectionsURLs","forEach","section","urlArray","is_directory","num","cfg","sesskey","url","sectionName","name","find","each","currSection","text","sectionURL","push","create","type","types","SAVE_CANCEL","body","sections","s","i","length","done","modal","getRoot","on","save","window","location","href","val","cancel","destroy","$activity","iconBackup","on_backup","$menu","li","first","clone","$backup","img","util","image_url","pix","html","css","create_special_activity_command","$button","activityClass","className","modtype","substr","indexOf","activityName","click","e","on_section_backup","_this","is_frontpage","valid","data","add_backup_command","theme","sectionID","$","split","$link","parent","unbind","sectionId","sectionNumber","courseId"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  Sharing Cart\n *\n *  @package    theme_snap\n *  @copyright  Copyright (c) 2020 Open LMS (https://www.openlms.net)\n *  @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nexport default class SharingCartForSnap {\n    constructor(courseSections) {\n        this.snapSpinner = '';\n        this.courseSections = courseSections;\n    }\n\n    /**\n     * Get a string from moodle\n     * @param {String} identifier\n     * @returns {String}\n     */\n    str = (identifier) => {\n        return M.str.block_sharing_cart[identifier] || M.str.moodle[identifier];\n    };\n    /**\n     * Sets a create command pointer\n     * @param create_command\n     */\n    setCreateCommand = (create_command) => {\n        this.create_command = create_command;\n    };\n    /**\n     *  Create a custom command icon\n     *  @param {String} cssClass The css class for the icon\n     *  @param {String} title The title and tooltip for the icon\n     *  @param {String} imageUrl Image URL for the icon\n     */\n    create_special_activity_command = (cssClass, title, imageUrl) => {\n        return $('<a href=\"javascript:void(0)\"/>')\n            .addClass(cssClass)\n            .addClass('dropdown-item menu-action cm-edit-action')\n            .attr('title', title)\n            .append(\n                $('<img class=\"icon\"/>')\n                    .attr('alt', title)\n                    .attr('src', imageUrl)\n            );\n    };\n    /**\n     * Adds a spinner when necessary\n     * @param spinner\n     */\n    addSpinner = (spinner) => {\n        if (this.snapSpinner) {\n            this.snapSpinner.show();\n        } else {\n            this.snapSpinner = spinner;\n        }\n    };\n    /**\n     * Hides the spinner if exist\n     */\n    hideSpinner = () => {\n        if (this.snapSpinner) {\n            this.snapSpinner.hide();\n        }\n    };\n    /**\n     * Creates a custom modal when restoring a sharing cart activity/module\n     * @param {Object} input\n     */\n    onRestore = (input) => {\n        const restore_targets = input.restore_targets;\n        const course = input.course;\n        const param = input.param;\n        const get_action_url = input.get_action_url;\n        const ModalFactory = input.ModalFactory;\n        const ModalEvents = input.ModalEvents;\n        const id = input.id;\n\n        var sectionsURLs = [];\n        this.courseSections.forEach(function(section) {\n            var urlArray = {\n                'directory': restore_targets.is_directory,\n                'course'   : course.id,\n                'section'  : section.num,\n                'sesskey'  : M.cfg.sesskey\n            };\n            urlArray[param] = id;\n            var url = get_action_url('restore', urlArray);\n\n            var sectionName = null;\n            if (section.name === null) {\n                $('#chapters').find('.chapter-title').each(function() {\n                    var currSection = $(this).attr('href');\n                    if (currSection == '#section-'+section.num) {\n                        sectionName = $(this).text();\n                    }\n                });\n            } else {\n                sectionName = section.name;\n            }\n            var sectionURL = {\n                name : sectionName,\n                url : url\n            };\n            sectionsURLs.push(sectionURL);\n        });\n\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: M.str.block_sharing_cart['restore'],\n            body: ((sections) => {\n                var s = M.str.block_sharing_cart['snap_dialog_restore'];\n                // Create Select element.\n                s += '<select id=\"select-dialog\" class=\"custom-select\">';\n                for(var i = 0; i < sections.length; i++) {\n                    s += '<option value=\"' + sections[i].url + '\">' + sections[i].name + '</option>';\n                }\n                s += '</select> <br> <br>';\n                return s;\n            })(sectionsURLs)\n        })\n            .done(function(modal) {\n                modal.show();\n                modal.getRoot().on(ModalEvents.save, function() {\n                    window.location.href = $('#select-dialog').val();\n                });\n                modal.getRoot().on(ModalEvents.cancel, function() {\n                    modal.destroy();\n                });\n            });\n    };\n\n    /**\n     *\n     * @param $activity\n     */\n    add_backup_command = ($activity, iconBackup, on_backup) => {\n        var $menu = $activity.find(\"ul[role='menu']\");\n\n        if($menu.length)\n        {\n            var li = $menu.find('li').first().clone();\n            var $backup = li.find('a').attr('title', this.str('backup'))\n                .attr('href', 'javascript:void(0)'); //eslint-disable-line no-script-url\n            var img = li.find('img');\n\n            if (img.length) {\n                li.find('img')\n                    .attr('alt', this.str('backup'))\n                    .attr('title', this.str('backup'))\n                    .attr('src', M.util.image_url(iconBackup.pix));\n            } else {\n                li.find('i')\n                    .attr('class', 'icon fa fa-upload')\n                    .attr('title', this.str('backup'))\n                    .attr('aria-label', this.str('backup'));\n            }\n\n            li.find('span').html(this.str('backup'));\n            $menu.append(li);\n        }\n        else\n        {\n            var $backup = this.create_command(\"backup\");\n            $menu = $activity.find('div[role=\"menu\"]');\n            if($menu.length)\n            {\n                const cssClass = iconBackup.css;\n                const title = this.str('backup');\n                const imageUrl =  M.util.image_url(iconBackup.pix);\n                $backup = this.create_special_activity_command(cssClass, title, imageUrl);\n\n                if($menu.css(\"display\") === \"none\")\n                {\n                    var $button = $menu.find('.editing_backup');\n                    if ($button.length == 0) {\n                        $menu.append($backup.attr(\"role\", \"menuitem\"));\n                        $backup.append($(\"<span class='menu-action-text'/>\").append($backup.attr('title')));\n                    }\n                }\n            }\n            else\n            {\n                $activity.find(\".commands\").append($backup);\n            }\n        }\n        // Get activity name\n        var activityClass = $activity[0].className;\n        var modtype = activityClass.substr(activityClass.indexOf('modtype_') + 8);\n        var activityName = this.str('activity_string');\n        if (modtype !== 'label') {\n            activityName = $('.activity#' + $activity[0].id)\n                .find('.activityinstance p.instancename')\n                .html();\n        }\n\n        $backup.click(function(e)\n        {\n            on_backup(e, activityName);\n        });\n    };\n\n    snapFix = (input) => {\n        const course = input.course;\n        const iconBackup = input.iconBackup;\n        const on_section_backup = input.on_section_backup;\n        const on_backup = input.on_backup;\n        const _this = this;\n\n        if(course.is_frontpage)\n        {\n            if($('.sitetopic li.activity').length > 0)\n            {\n                var valid = $('.sitetopic li.activity').data('block-sharing-cart');\n                if(valid !== 'done')\n                {\n                    $('.sitetopic li.activity').each(function()\n                    {\n                        _this.add_backup_command($(this), iconBackup, on_backup);\n                    });\n                    $('.sitetopic li.activity').data(\"block-sharing-cart\", \"done\");\n                }\n            }\n            if($('.block_site_main_menu').length > 0)\n            {\n                var valid = $('.block_site_main_menu .content > ul >  li').data('block-sharing-cart');\n                if(valid !== 'done')\n                {\n                    $('.block_site_main_menu .content > ul >  li').each(function()\n                    {\n                        _this.add_backup_command($(this), iconBackup, on_backup);\n                    });\n                    $('.block_site_main_menu .content > ul >  li').data(\"block-sharing-cart\", \"done\");\n                }\n            }\n        }\n        else\n        {\n            if($('.course-content li.activity').length > 0)\n            {\n                var valid = $('.course-content li.activity').data('block-sharing-cart');\n                if(valid !== 'done' || this.courseSections.length == 1)\n                {\n                    $('.course-content li.activity').each(function()\n                    {\n                        _this.add_backup_command($(this), iconBackup, on_backup);\n                    });\n                    $('.course-content li.activity').data(\"block-sharing-cart\", \"done\");\n                }\n            }\n        }\n\n        if (M.cfg.theme !== 'snap') {\n            let _this = this;\n            $(\"li.section\").each(function () {\n                var sectionID = $(this).find(\"div.content h3.sectionname span.inplaceeditable\").attr(\"data-itemid\");\n\n                var $menu = $(this).find(\"ul[role='menu']\").first();\n\n                if ($menu.length){\n                    var li = $menu.find('li').first().clone();\n                    var img = li.find('img');\n\n                    if (img.length) {\n                        img.attr('alt', _this.str('backup'))\n                            .attr('title', _this.str('backup'))\n                            .attr('src', M.util.image_url(iconBackup.pix, null));\n                    } else {\n                        li.find('i')\n                            .attr('class', 'icon fa fa-upload')\n                            .attr('title', _this.str('backup'))\n                            .attr('aria-label', _this.str('backup'));\n                    }\n\n                    li.find('span').html(_this.str('backup'));\n                    li.find('a').attr('href', 'javascript:void(0)'); //eslint-disable-line no-script-url\n\n                    $menu.append(li);\n\n                    li.find('a').click(function () {\n                        on_section_backup(sectionID);\n                    });\n                }\n                else {\n                    $menu = $(this).find(\"div[role='menu']\").first();\n\n                    var $backup = null;\n\n                    if ($menu.length) {\n                        const cssClass = iconBackup.css;\n                        const title = _this.str('backup');\n                        const imageUrl =  M.util.image_url(iconBackup.pix);\n                        $backup = _this.create_special_activity_command(cssClass, title, imageUrl);\n                        $menu.append($backup.attr(\"role\", \"menuitem\"));\n\n                        if ($menu.css(\"display\") === \"none\") {\n                            $backup.append($(\"<span class='menu-action-text'/>\").append($backup.attr('title')));\n                        }\n                    }\n                    else {\n                        $backup = _this.create_command(\"backup\");\n                        $(this).find(\".commands\").append($backup);\n                    }\n\n                    $backup.click(function () {\n                        on_section_backup(sectionID);\n                    });\n                }\n            });\n        } else {\n            $.each($(\"a.snap-delete\"), function(i, val)\n            {\n                var sectionID = $(val).attr(\"href\").split('?')[1].split('&')[0].split('=')[1];\n                var $link = $('<a/>').attr('class', 'snap-sharing-cart').attr('role', 'button').attr('id', sectionID);\n                $link.attr('tabindex', '0').attr('title', 'Backup Section');\n                var $button = $(val).parent().find('a.snap-sharing-cart');\n                if ($button.length == 0) {\n                    $(val).parent().append($link);\n                }\n            });\n\n            $('a.snap-sharing-cart').unbind().click(function () {\n                const sectionId = $(this).attr('id');\n                const section = _this.courseSections ? _this.courseSections.find(section => section['id'] === sectionId)\n                    : {num: 0, name: undefined};\n                const sectionNumber = section['num'];\n                const courseId = course.id;\n                const sectionName = section['name'] === null ? undefined : section['name'];\n                on_section_backup(sectionId, sectionNumber, courseId, sectionName);\n            });\n        }\n    };\n}"],"file":"sharing_cart.min.js"}